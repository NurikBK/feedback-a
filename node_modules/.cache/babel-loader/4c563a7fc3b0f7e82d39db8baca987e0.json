{"ast":null,"code":"import _objectSpread from\"/home/nurik/feedback-a/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/home/nurik/feedback-a/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"/home/nurik/feedback-a/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/nurik/feedback-a/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/nurik/feedback-a/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{createContext,useState,useEffect}from'react';import FeedbackData from'../data/feedbackData';import{jsx as _jsx}from\"react/jsx-runtime\";var FeedbackContext=/*#__PURE__*/createContext();export var FeedbackProvider=function FeedbackProvider(_ref){var children=_ref.children;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsloading=_useState2[1];var _useState3=useState(FeedbackData),_useState4=_slicedToArray(_useState3,2),feedback=_useState4[0],setFeedback=_useState4[1];var _useState5=useState({item:{},edit:false}),_useState6=_slicedToArray(_useState5,2),feedbackEdit=_useState6[0],setFeedbackEdit=_useState6[1];useEffect(function(){fetchData();setIsloading(false);},[]);function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch('/feedback');case 2:res=_context.sent;_context.next=5;return res.json();case 5:data=_context.sent;setFeedback(data);case 7:case\"end\":return _context.stop();}}},_callee);}));return _fetchData.apply(this,arguments);}function handleDelete(_x){return _handleDelete.apply(this,arguments);}function _handleDelete(){_handleDelete=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(id){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!window.confirm('Are you sure you want to delete')){_context2.next=4;break;}_context2.next=3;return fetch(\"/feedback/\".concat(id),{method:'DELETE'});case 3:setFeedback(feedback.filter(function(item){return item.id!=id;}));case 4:case\"end\":return _context2.stop();}}},_callee2);}));return _handleDelete.apply(this,arguments);}function handleAdd(_x2){return _handleAdd.apply(this,arguments);}function _handleAdd(){_handleAdd=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(newFeedback){var res,data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch('/feedback',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(newFeedback)});case 2:res=_context3.sent;_context3.next=5;return res.json();case 5:data=_context3.sent;setFeedback([data].concat(_toConsumableArray(feedback)));case 7:case\"end\":return _context3.stop();}}},_callee3);}));return _handleAdd.apply(this,arguments);}function updateFeedback(_x3,_x4){return _updateFeedback.apply(this,arguments);}function _updateFeedback(){_updateFeedback=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(id,updItem){var res,data;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return fetch(\"feedback/\".concat(id),{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify(updItem)});case 2:res=_context4.sent;_context4.next=5;return res.json();case 5:data=_context4.sent;setFeedback(feedback.map(function(item){return item.id===id?_objectSpread(_objectSpread({},item),data):item;}));case 7:case\"end\":return _context4.stop();}}},_callee4);}));return _updateFeedback.apply(this,arguments);}function editFeedback(item){setFeedbackEdit({item:item,edit:true});}return/*#__PURE__*/_jsx(FeedbackContext.Provider,{value:{feedback:feedback,feedbackEdit:feedbackEdit,isLoading:isLoading,handleDelete:handleDelete,handleAdd:handleAdd,editFeedback:editFeedback,updateFeedback:updateFeedback},children:children});};export default FeedbackContext;","map":{"version":3,"names":["createContext","useState","useEffect","FeedbackData","FeedbackContext","FeedbackProvider","children","isLoading","setIsloading","feedback","setFeedback","item","edit","feedbackEdit","setFeedbackEdit","fetchData","fetch","res","json","data","handleDelete","id","window","confirm","method","filter","handleAdd","newFeedback","headers","body","JSON","stringify","updateFeedback","updItem","map","editFeedback"],"sources":["/home/nurik/feedback-a/src/context/FeedbackContext.js"],"sourcesContent":["import { createContext, useState, useEffect } from 'react';\nimport FeedbackData from '../data/feedbackData';\n\nconst FeedbackContext = createContext();\n\nexport const FeedbackProvider = ({ children }) => {\n  const [isLoading, setIsloading] = useState(true);\n  const [feedback, setFeedback] = useState(FeedbackData);\n  const [feedbackEdit, setFeedbackEdit] = useState({\n    item: {},\n    edit: false,\n  });\n\n  useEffect(() => {\n    fetchData();\n    setIsloading(false);\n  }, []);\n\n  async function fetchData() {\n    const res = await fetch('/feedback');\n    const data = await res.json();\n    setFeedback(data);\n  }\n\n  async function handleDelete(id) {\n    if (window.confirm('Are you sure you want to delete')) {\n      await fetch(`/feedback/${id}`, {\n        method: 'DELETE',\n      });\n      setFeedback(feedback.filter((item) => item.id != id));\n    }\n  }\n\n  async function handleAdd(newFeedback) {\n    const res = await fetch('/feedback', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(newFeedback),\n    });\n    const data = await res.json();\n\n    setFeedback([data, ...feedback]);\n  }\n\n  async function updateFeedback(id, updItem) {\n    const res = await fetch(`feedback/${id}`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(updItem),\n    });\n\n    const data = await res.json();\n\n    setFeedback(\n      feedback.map((item) => (item.id === id ? { ...item, ...data } : item))\n    );\n  }\n\n  function editFeedback(item) {\n    setFeedbackEdit({\n      item,\n      edit: true,\n    });\n  }\n\n  return (\n    <FeedbackContext.Provider\n      value={{\n        feedback,\n        feedbackEdit,\n        isLoading,\n        handleDelete,\n        handleAdd,\n        editFeedback,\n        updateFeedback,\n      }}\n    >\n      {children}\n    </FeedbackContext.Provider>\n  );\n};\n\nexport default FeedbackContext;\n"],"mappings":"mjBAAA,OAASA,aAAT,CAAwBC,QAAxB,CAAkCC,SAAlC,KAAmD,OAAnD,CACA,MAAOC,aAAP,KAAyB,sBAAzB,C,2CAEA,GAAMC,gBAAe,cAAGJ,aAAa,EAArC,CAEA,MAAO,IAAMK,iBAAgB,CAAG,QAAnBA,iBAAmB,MAAkB,IAAfC,SAAe,MAAfA,QAAe,CAChD,cAAkCL,QAAQ,CAAC,IAAD,CAA1C,wCAAOM,SAAP,eAAkBC,YAAlB,eACA,eAAgCP,QAAQ,CAACE,YAAD,CAAxC,yCAAOM,QAAP,eAAiBC,WAAjB,eACA,eAAwCT,QAAQ,CAAC,CAC/CU,IAAI,CAAE,EADyC,CAE/CC,IAAI,CAAE,KAFyC,CAAD,CAAhD,yCAAOC,YAAP,eAAqBC,eAArB,eAKAZ,SAAS,CAAC,UAAM,CACda,SAAS,GACTP,YAAY,CAAC,KAAD,CAAZ,CACD,CAHQ,CAGN,EAHM,CAAT,CARgD,QAajCO,UAbiC,uIAahD,wKACoBC,MAAK,CAAC,WAAD,CADzB,QACQC,GADR,qCAEqBA,IAAG,CAACC,IAAJ,EAFrB,QAEQC,IAFR,eAGET,WAAW,CAACS,IAAD,CAAX,CAHF,sDAbgD,oDAmBjCC,aAnBiC,kJAmBhD,kBAA4BC,EAA5B,4HACMC,MAAM,CAACC,OAAP,CAAe,iCAAf,CADN,iDAEUP,MAAK,qBAAcK,EAAd,EAAoB,CAC7BG,MAAM,CAAE,QADqB,CAApB,CAFf,QAKId,WAAW,CAACD,QAAQ,CAACgB,MAAT,CAAgB,SAACd,IAAD,QAAUA,KAAI,CAACU,EAAL,EAAWA,EAArB,EAAhB,CAAD,CAAX,CALJ,wDAnBgD,uDA4BjCK,UA5BiC,0IA4BhD,kBAAyBC,WAAzB,4JACoBX,MAAK,CAAC,WAAD,CAAc,CACnCQ,MAAM,CAAE,MAD2B,CAEnCI,OAAO,CAAE,CACP,eAAgB,kBADT,CAF0B,CAKnCC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeJ,WAAf,CAL6B,CAAd,CADzB,QACQV,GADR,uCAQqBA,IAAG,CAACC,IAAJ,EARrB,QAQQC,IARR,gBAUET,WAAW,EAAES,IAAF,4BAAWV,QAAX,GAAX,CAVF,wDA5BgD,oDAyCjCuB,eAzCiC,6JAyChD,kBAA8BX,EAA9B,CAAkCY,OAAlC,4JACoBjB,MAAK,oBAAaK,EAAb,EAAmB,CACxCG,MAAM,CAAE,KADgC,CAExCI,OAAO,CAAE,CACP,eAAgB,kBADT,CAF+B,CAKxCC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeE,OAAf,CALkC,CAAnB,CADzB,QACQhB,GADR,uCASqBA,IAAG,CAACC,IAAJ,EATrB,QASQC,IATR,gBAWET,WAAW,CACTD,QAAQ,CAACyB,GAAT,CAAa,SAACvB,IAAD,QAAWA,KAAI,CAACU,EAAL,GAAYA,EAAZ,gCAAsBV,IAAtB,EAA+BQ,IAA/B,EAAwCR,IAAnD,EAAb,CADS,CAAX,CAXF,wDAzCgD,iDAyDhD,QAASwB,aAAT,CAAsBxB,IAAtB,CAA4B,CAC1BG,eAAe,CAAC,CACdH,IAAI,CAAJA,IADc,CAEdC,IAAI,CAAE,IAFQ,CAAD,CAAf,CAID,CAED,mBACE,KAAC,eAAD,CAAiB,QAAjB,EACE,KAAK,CAAE,CACLH,QAAQ,CAARA,QADK,CAELI,YAAY,CAAZA,YAFK,CAGLN,SAAS,CAATA,SAHK,CAILa,YAAY,CAAZA,YAJK,CAKLM,SAAS,CAATA,SALK,CAMLS,YAAY,CAAZA,YANK,CAOLH,cAAc,CAAdA,cAPK,CADT,UAWG1B,QAXH,EADF,CAeD,CA/EM,CAiFP,cAAeF,gBAAf"},"metadata":{},"sourceType":"module"}